{
    "paper_id": "9c6ef4acc649938134d878e2d85f15ff13086db6",
    "metadata": {
        "title": "Capturing sequence diversity in metagenomes with comprehensive and scalable probe design SUPPLEMENTARY INFORMATION",
        "authors": [
            {
                "first": "Hayden",
                "middle": [
                    "C"
                ],
                "last": "Metsky",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": "hayden@mit.edu"
            },
            {
                "first": "Katherine",
                "middle": [
                    "J"
                ],
                "last": "Siddle",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": "kjsiddle@broadinstitute.org"
            },
            {
                "first": "Adrianne",
                "middle": [],
                "last": "Gladden-Young",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "James",
                "middle": [],
                "last": "Qu",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "David",
                "middle": [
                    "K"
                ],
                "last": "Yang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Patrick",
                "middle": [],
                "last": "Brehio",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Andrew",
                "middle": [],
                "last": "Goldfarb",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Harvard University",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Anne",
                "middle": [],
                "last": "Piantadosi",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Shirlee",
                "middle": [],
                "last": "Wohl",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Amber",
                "middle": [],
                "last": "Carter",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Aaron",
                "middle": [
                    "E"
                ],
                "last": "Lin",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Kayla",
                "middle": [
                    "G"
                ],
                "last": "Barnes",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Damien",
                "middle": [
                    "C"
                ],
                "last": "Tully",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Bj\u00f6rn",
                "middle": [],
                "last": "Corleis",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Scott",
                "middle": [],
                "last": "Hennigan",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Giselle",
                "middle": [],
                "last": "Barbosa-Lima",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fundac\u0327a\u0303o Oswaldo Cruz (FIOCRUZ)",
                    "location": {
                        "settlement": "Rio de Janeiro, Rio de Janeiro",
                        "country": "Brazil"
                    }
                },
                "email": ""
            },
            {
                "first": "Yasmine",
                "middle": [
                    "R"
                ],
                "last": "Vieira",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fundac\u0327a\u0303o Oswaldo Cruz (FIOCRUZ)",
                    "location": {
                        "settlement": "Rio de Janeiro, Rio de Janeiro",
                        "country": "Brazil"
                    }
                },
                "email": ""
            },
            {
                "first": "Lauren",
                "middle": [
                    "M"
                ],
                "last": "Paul",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Florida Gulf Coast University",
                    "location": {
                        "settlement": "Fort Myers",
                        "region": "FL",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Amanda",
                "middle": [
                    "L"
                ],
                "last": "Tan",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Florida Gulf Coast University",
                    "location": {
                        "settlement": "Fort Myers",
                        "region": "FL",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Kimberly",
                "middle": [
                    "F"
                ],
                "last": "Garcia",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad Nacional Auto\u0301 noma de Honduras",
                    "location": {
                        "settlement": "Tegucigalpa",
                        "country": "Honduras"
                    }
                },
                "email": ""
            },
            {
                "first": "Leda",
                "middle": [
                    "A"
                ],
                "last": "Parham",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad Nacional Auto\u0301 noma de Honduras",
                    "location": {
                        "settlement": "Tegucigalpa",
                        "country": "Honduras"
                    }
                },
                "email": ""
            },
            {
                "first": "Ikponmwosa",
                "middle": [],
                "last": "Odia",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Irrua Specialist Teaching Hospital",
                    "location": {
                        "settlement": "Irrua",
                        "country": "Nigeria"
                    }
                },
                "email": ""
            },
            {
                "first": "Philomena",
                "middle": [],
                "last": "Eromon",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Redeemer's University",
                    "location": {
                        "settlement": "Ede",
                        "country": "Nigeria"
                    }
                },
                "email": ""
            },
            {
                "first": "Onikepe",
                "middle": [
                    "A"
                ],
                "last": "Folarin",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Redeemer's University",
                    "location": {
                        "settlement": "Ede",
                        "country": "Nigeria"
                    }
                },
                "email": ""
            },
            {
                "first": "Augustine",
                "middle": [],
                "last": "Goba",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Etienne",
                "middle": [],
                "last": "Simon-Lori\u00e8re",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Lisa",
                "middle": [],
                "last": "Hensley",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Integrated Research Facility, Division of Clinical Research, National Institute of Allergy and Infectious Diseases",
                    "institution": "US National Institutes of Health",
                    "location": {
                        "settlement": "Frederick",
                        "region": "MD",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Angel",
                "middle": [],
                "last": "Balmaseda",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Laboratorio Nacional de Virolog\u00eda, Centro Nacional de Diagn\u00f3stico y Referencia",
                    "institution": "Ministry of Health",
                    "location": {
                        "settlement": "Managua",
                        "country": "Nicaragua"
                    }
                },
                "email": ""
            },
            {
                "first": "Eva",
                "middle": [],
                "last": "Harris",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "settlement": "Berkeley, Berkeley",
                        "region": "CA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Douglas",
                "middle": [
                    "S"
                ],
                "last": "Kwon",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Massachusetts General Hospital",
                    "location": {
                        "settlement": "Boston",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Todd",
                "middle": [
                    "M"
                ],
                "last": "Allen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Jonathan",
                "middle": [
                    "A"
                ],
                "last": "Runstadler",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Tufts University",
                    "location": {
                        "settlement": "North Grafton",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Sandra",
                "middle": [],
                "last": "Smole",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Fernando",
                "middle": [
                    "A"
                ],
                "last": "Bozza",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fundac\u0327a\u0303o Oswaldo Cruz (FIOCRUZ)",
                    "location": {
                        "settlement": "Rio de Janeiro, Rio de Janeiro",
                        "country": "Brazil"
                    }
                },
                "email": ""
            },
            {
                "first": "Thiago",
                "middle": [
                    "M L"
                ],
                "last": "Souza",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fundac\u0327a\u0303o Oswaldo Cruz (FIOCRUZ)",
                    "location": {
                        "settlement": "Rio de Janeiro, Rio de Janeiro",
                        "country": "Brazil"
                    }
                },
                "email": ""
            },
            {
                "first": "Sharon",
                "middle": [],
                "last": "Isern",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Florida Gulf Coast University",
                    "location": {
                        "settlement": "Fort Myers",
                        "region": "FL",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Scott",
                "middle": [
                    "F"
                ],
                "last": "Michael",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Florida Gulf Coast University",
                    "location": {
                        "settlement": "Fort Myers",
                        "region": "FL",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Ivette",
                "middle": [],
                "last": "Lorenzana",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad Nacional Auto\u0301 noma de Honduras",
                    "location": {
                        "settlement": "Tegucigalpa",
                        "country": "Honduras"
                    }
                },
                "email": ""
            },
            {
                "first": "Lee",
                "middle": [],
                "last": "Gehrke",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Massachusetts Institute of Technology",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Irene",
                "middle": [],
                "last": "Bosch",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Massachusetts Institute of Technology",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Gregory",
                "middle": [],
                "last": "Ebel",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Colorado State University",
                    "location": {
                        "addrLine": "Fort Collins",
                        "region": "CO",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Donald",
                "middle": [
                    "S"
                ],
                "last": "Grant",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Sierra Leone",
                    "location": {
                        "settlement": "Freetown",
                        "region": "Sierra"
                    }
                },
                "email": ""
            },
            {
                "first": "Christian",
                "middle": [
                    "T"
                ],
                "last": "Happi",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Harvard University",
                    "location": {
                        "settlement": "Boston",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Daniel",
                "middle": [
                    "J"
                ],
                "last": "Park",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Andreas",
                "middle": [],
                "last": "Gnirke",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Pardis",
                "middle": [
                    "C"
                ],
                "last": "Sabeti",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Christian",
                "middle": [
                    "B"
                ],
                "last": "Matranga",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Broad Institute of MIT and Harvard",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [],
    "body_text": [
        {
            "text": "CATCH models hybridization between each candidate probe and the target sequences. Doing so allows CATCH to decide whether a candidate probe captures (or 'covers') a region of the target sequence, and thus find a probe set that achieves a desired coverage of the target sequences under this model. For whole genome enrichment, the desired coverage would typically be 100% of each target sequence. (a) Relatively conserved regions (for example, a particular gene) in the input sequences can be captured with few probes because it is likely that any given probe, under a model of hybridization, will capture observed variation across many or all of the input sequences. Highly variable regions may require many probes to be captured because each given probe may capture the observed variation across only a small fraction of the input sequences. (b) By default, CATCH decides whether a probe hybridizes to a region of a target sequence according to the following parameters: a number m of mismatches to tolerate and a length lcf of a longest common substring. CATCH computes the longest common substring with at most m mismatches between the probe and target subsequence, and decides that the probe hybridizes to the target if and only if the length of this is at least lcf. If the parameter i is provided, CATCH additionally requires that the probe and target subsequence share an exact (0-mismatch) match of length at least i. If CATCH decides that the probe hybridizes to the subsequence of the target with which it shares a substring, then it determines that the probe captures the region equal to the length of the probe as well as e nt on each side of this region. e, termed a cover extension, is a parameter whose value can be specified to CATCH, along with m, lcf, and i. Lower values of m, higher values of lcf, higher values of i, and lower values of e are more conservative and lead to more probe sequences. (For details, see the description of fmap in Online Methods.) (c) Number of probes required to fully capture 300 genomes of HCV, HIV-1, EBOV, and ZIKV, for varying values of the mismatches and cover extension parameters, with other parameters fixed. Shaded regions are 95% pointwise confidence bands calculated across randomly sampled input genomes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Scaling probe count with diversity of viral genomes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 2"
        },
        {
            "text": "Number of probes required to fully capture increasing numbers of HIV-1, EBOV, and ZIKV genomes. Approaches shown are simple tiling (gray), a clustering-based approach at two levels of stringency (red; see Supplementary Note 2 for details), and CATCH at three choices of parameters (blue). Shaded regions are 95% pointwise confidence bands calculated across randomly sampled input genomes. Design of the VWAFR probe set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 2"
        },
        {
            "text": "(a) Number of probes designed by CATCH for each dataset among all 89,990 probes in the VWAFR probe set. The total includes reverse complement probes, which were added to the design of VWAFR for synthesis. (b) Values of two parameters selected by CATCH for each dataset in the design of VWAFR: number of mismatches to tolerate in hybridization and length of the target fragment (in nt) on each side of the hybridized region assumed to be captured along with the hybridized region (cover extension). The label within each bubble is the number of datasets that were assigned a particular combination of values. Species included in our sample testing are labeled; for full list of parameter values, see Supplementary Table 1 . Depth of coverage observed across viral genomes from samples with known viral infections.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 699,
                    "end": 720,
                    "text": "Supplementary Table 1",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 2"
        },
        {
            "text": "Depth of coverage across 31 viral genomes from the analysis of 30 patient and environmental samples with known viral infections (one sample contained two known viruses). Shown on (a) linear and (b) logarithmic scales. The logarithmic scale helps compare variance in depth across each genome between pre-and post-captured data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 2"
        },
        {
            "text": "Relation between enrichment of viral content and viral titer.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 5"
        },
        {
            "text": "Fraction of all downsampled pre-capture reads that mapped to the reference genome (shown on the horizontal axis) for 24 viral genomes reflects a wide range of initial viral concentrations in these samples. Enrichment (shown on the vertical axis) was calculated by dividing the total number of post-capture reads mapping to a reference genome by the number of mapped pre-capture reads. Those with the highest viral content showed lower enrichment following capture with VALL. Seven of the 31 viral genomes included in the analysis are excluded from this plot because they yielded fewer than 200,000 total reads (Supplementary Table 3 ). Two IAV samples with a high fraction of viral reads pre-capture (bottom right) overlap on the plot. One sample (ZIKV-SM3, top left) showed no viral reads pre-capture, so its fold-change is undefined. Metagenomic sequencing results for pre-and post-capture samples.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 625,
                    "end": 632,
                    "text": "Table 3",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 5"
        },
        {
            "text": "(a) Number of species detected (with at least 1 assigned read) in samples with known viral infections. Counts are shown before capture (orange), after capture with VWAFR (light blue), and after capture with VALL (dark blue). (b) Left: Number of reads detected for each species across samples with known viral infections, before and after capture with VWAFR. Right: Abundance of each species before capture and fold-change upon capture with VWAFR. For each sample, the virus known to be present in the sample is colored, and Homo sapiens matches in samples from humans are shown in black. (c) Number of reads detected for each species across uncharacterized sample pools, before and after capture with VALL. Viral species present in each sample (Fig. 4b) Genome assembly in EBOV dilution series and effect of sequencing depth on amount of viral material sequenced.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 744,
                    "end": 753,
                    "text": "(Fig. 4b)",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 5"
        },
        {
            "text": "(a) Percent of viral genome assembled in a dilution series of viral input in two amounts of human RNA background. There are n=2 technical replicates for each choice of input copies, background amount, and use of capture (n=1 replicate for the negative control with 0 copies). Each dot indicates percent of genome assembled, from 200,000 reads, in a replicate; line is through the mean of the replicates. Label to the right of each line indicates amount of background material. Assemblies are from read data presented in Fig. 3a. (b) Number of unique viral reads sequenced at increasing sequencing depth, from an input of 10 3 viral copies in different amounts of background. Horizontal axis gives the number of total reads to which a sample was subsampled. Each line is a technical replicate (n=2) and shaded regions are 95% pointwise confidence bands calculated across random subsamplings. Dashed vertical line at 200,000 reads denotes the amount of total reads used in (a) and in Fig. 3a . Viral sequencing data generated after capture with VALL saturates more quickly than without capture. (c) Same as (b), but from an input of 10 4 viral copies.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 520,
                    "end": 528,
                    "text": "Fig. 3a.",
                    "ref_id": null
                },
                {
                    "start": 982,
                    "end": 989,
                    "text": "Fig. 3a",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 5"
        },
        {
            "text": "Enrichment in read depth with focused probe sets.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 8"
        },
        {
            "text": "(a) Distribution of the enrichment in read depth, across viral genomes, provided by capture with VWAFR. Each curve represents a viral genome. At each position across a genome, the post-capture read depth is divided by the pre-capture depth, and the plotted curve is the empirical cumulative distribution of the log of these fold-change values. (b) Distribution of the enrichment in read depth, across viral genomes, provided by VWAFR over VALL. At each position across a genome, the read depth following capture with VWAFR is divided by the depth following capture with VALL, and the plotted curve is the empirical cumulative distribution of the log of these fold-change values. (c) Same as (a), but for the two-virus probe sets VMM and VZC. The mumps curves (green) show enrichment provided by VMM against pre-capture, and the Zika curves (purple) show enrichment provided by VZC against pre-capture. (d) Same as (b), but for the two-virus probe sets VMM and VZC. The mumps curves (green) show enrichment provided by VMM against VALL, and the Zika curves (purple) show enrichment provided by VZC against VALL. (a) Number of unique LASV reads, among 200,000 reads in total, sequenced following capture with VALL compared to pre-capture in 23 samples from the 2018 Lassa fever outbreak. Points are colored by the state in Nigeria that the sample is from (black is NTC). (b) Percent of LASV genome assembled, after use of VALL, against the fraction of pre-capture reads that are LASV. Points to the left of the horizontal break correspond to samples with no LASV reads pre-capture. As in Fig. 4a , reads were downsampled to 200,000 before assembly. Points are colored as in (a). (c) Percent of LASV genome assembled, after use of VALL. Here, reads were not downsampled before assembly. Bars are ordered as in Fig. 4a and colored by the state in Nigeria that the sample is from. Di\u21b5erential identification, blacklisting sequence, and partial coverage",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1586,
                    "end": 1593,
                    "text": "Fig. 4a",
                    "ref_id": null
                },
                {
                    "start": 1807,
                    "end": 1814,
                    "text": "Fig. 4a",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 8"
        },
        {
            "text": "There are many problems related to probe design that map well to generalizations of the set cover problem. Relevant generalizations are the weighted and partial cover problems 1-3 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 8"
        },
        {
            "text": "Using the weighted cover problem, CATCH allows a user to perform di\u21b5erential identification of taxa and also to blacklist sequences from the probe design. For these purposes, we introduce the concept of a \"rank\" to our implementation of the set cover solution. A rank of a set is analogous to a weight and makes it straightforward to assign levels of penalties on sets. For two sets S and T , if rank(S) < rank(T ) then S is always considered before T -i.e., if coverage is needed and S provides that coverage, then the greedy algorithm always chooses S before T even if T provides more. These can be emulated using weights (i.e., costs), by assigning su ciently high weights to each set. To perform di\u21b5erential identification, CATCH accepts groupings of sequences as input (for example, each grouping might encompass the available genomes of a species). Then, CATCH finds the number of groupings that each candidate probe p \"hits\". (p hits a grouping if it covers a part of at least one sequence in that grouping.) A probe that hits only one grouping is suitable for di\u21b5erential identification, whereas ones that hit more are poor choices. Thus, CATCH assigns a rank to each p equal to the number of groupings hit by p. CATCH can also accept a collection of sequences to blacklist from the probe design. It determines the number of nucleotides in blacklisted sequence that each p covers and assigns to p a rank equal to this value; therefore, candidate probes that cover blacklisted sequence are highly penalized in the design. (When a user opts to perform di\u21b5erential identification while also blacklisting sequences, the ranks are assigned such that a candidate probe that covers a part of a blacklisted sequence always receives a higher rank than one that does not.) For the purposes of determining whether p hits an identification grouping or blacklisted sequence, CATCH accepts three additional parameters, holding more tolerant values for m, lcf, and i as defined above, that f map uses to evaluate probe-target hybridization. We note as well that weights can have other applications in probe design, e.g., if there is a reason to prefer some candidate probes over others due to base composition. Finally, CATCH solves an instance of the weighted cover problem by assigning the rank of each set to be the rank of the candidate probe it represents.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 8"
        },
        {
            "text": "Based on the partial cover problem, CATCH o\u21b5ers the ability to design probes such that they only cover a portion of each target sequence. The user specifies this portion as either a fraction of the length of each sequence or as a fixed number of nucleotides. Reducing the problem directly to an instance of the set cover problem with a single universe would not allow partially covering each target sequence. Thus, as a heuristic, we introduce \"multiple universes\" to the instance, in which each universe corresponds to a target sequence and consists of all the bases in that sequence. Each set (representing candidate probes) specifies which elements in which universes it covers. The greedy algorithm continues selecting among the candidate probes until it obtains the desired partial coverage of each universe (target sequence). We do not make claims about the approximation factor this achieves. As one application, note that when performing di\u21b5erential identification the required partial coverage should be set to be relatively low.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Figure 8"
        },
        {
            "text": "If desired, CATCH adds adapters to probe sequences in s(d, \u2713 d ) for PCR amplification. Because probe sequences may overlap, it is possible that, during PCR, they could chain together to form concatemers. Thus, we would like to use k unique adapters and divide the probes in s(d, \u2713 d ) into k groups such that the probes in each group are unlikely to chain together; then, we can perform PCR separately on each group. CATCH uses a heuristic to solve this problem for k = 2, i.e., two adapters A and B. Consider one target sequence t. It maps each of the probes in s(d, \u2713 d ) to t using f map , as described above. It treats the ranges that each probe covers as an \"interval,\" and finds the largest set of non-overlapping intervals (probes) T no by solving an instance of the interval scheduling problem. Then, we could assign adapter A to each probe in T no , and adapter B to each of the others. CATCH performs this for each target sequence t, and each t \"votes\" once (either A or B) for each probe. We seek to maximize the sum, across all probes, of the majority vote for the probe (to ensure a clear decision on the adapter for each probe). Let V p A be the number of A votes for a probe, and likewise for V p B . Then, we wish to maximize the quantity X",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Adapters for amplification"
        },
        {
            "text": "Since the distinction between A and B is arbitrary, at each t CATCH chooses whether to assign A or B votes to the probes in T no depending on which assignment yields a higher sum. This process yields the maximum sum, and CATCH then assigns adapter A or B to each probe based on which has more votes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Adapters for amplification"
        },
        {
            "text": "In all evaluations of how probe counts grow with respect to an independent variable (Supplementary Fig. 1c, Fig. 1b , and Supplementary Fig. 2 ), we used genome neighbors from NCBI's accession list of viral genomes 4 (downloaded in September, 2017) as input. We trimmed long terminal repeats from HIV-1 sequences. The specific sequences are available at https://github.com/broadinstitute/catch/tree/323b639/hybseldesign/datasets/data. In all of these evaluations, we designed 75 nt probes.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 99,
                    "end": 115,
                    "text": "Fig. 1c, Fig. 1b",
                    "ref_id": null
                },
                {
                    "start": 122,
                    "end": 142,
                    "text": "Supplementary Fig. 2",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Note 2"
        },
        {
            "text": "In the plots showing probe counts as a function of parameter values ( Supplementary Fig.  1c ), we varied only the mismatches (m) and cover extension (e) parameters using the values shown. We set parameters on the longest common substring (lcf ) and island of exact match (i) to their default values: lcf equal to the probe length (75) and i = 0. For each pair of parameter values shown, we calculated probe counts across 5 replicates, with the input to each replicate being 300 genomes that were randomly selected with replacement. Shaded regions are 95% pointwise confidence bands.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 70,
                    "end": 92,
                    "text": "Supplementary Fig.  1c",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Note 2"
        },
        {
            "text": "In the plots showing how probe counts scale with the number of input genomes ( Fig. 1b and Supplementary Fig. 2) , the \"Baseline\" approach generates probes by tiling each input genome with a stride of 25 nt and removing exact duplicates. The \"Clustering-based\" approach generates candidate probes using a stride of 25 nt and deems two probes to be redundant if their longest common substring up to m mismatches (shown at m = 0 and m = 4) is at least 65 nt. It then constructs a graph in which vertices represent candidate probes and edges represent redundancy, and finds a probe set by approximating the smallest dominating set of this graph. For running this clustering-based approach, see the design naively.py executable in our implementation of CATCH. The CATCH approach generates candidate probes using a stride of 25 nt and is shown with parameter values (m = 0, e = 0), (m = 4, e = 0), and (m = 4, e = 50), and all other parameters set to default values. Probe counts for hepatitis C virus and HIV-1 were calculated and plotted with n = {1, 50, 100, 200, 300, . . . , 1000} input genomes; for Zaire ebolavirus, n = {1, 50, 100, 150, . . . , 850} input genomes; and for Zika virus, n = {1, 25, 50, 75, . . . , 375} input genomes. For each n, we calculated probe counts across 5 replicates, with the input to each replicate being n genomes that were randomly selected with replacement. Again, shaded regions are 95% pointwise confidence bands.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 79,
                    "end": 86,
                    "text": "Fig. 1b",
                    "ref_id": null
                },
                {
                    "start": 91,
                    "end": 112,
                    "text": "Supplementary Fig. 2)",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Note 2"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "of the Viral Hemorrhagic Fever Consortium",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Kenema Government Hospital",
            "authors": [
                {
                    "first": "Mohammed",
                    "middle": [],
                    "last": "Fullah",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Kenema Government Hospital",
            "authors": [
                {
                    "first": "Augustine",
                    "middle": [],
                    "last": "Goba",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Simbirie Jalloh (Kenema Government Hospital",
            "authors": [
                {
                    "first": "Donald",
                    "middle": [],
                    "last": "Grant",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Mambu Momoh (Kenema Government Hospital",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "A greedy heuristic for the Set-Covering problem",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Chvatal",
                    "suffix": ""
                }
            ],
            "year": 1979,
            "venue": "Math. Oper. Res",
            "volume": "4",
            "issn": "",
            "pages": "233--235",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Improved performance of the greedy algorithm for partial cover",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Slav\u00edk",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "Inf. Process. Lett",
            "volume": "64",
            "issn": "",
            "pages": "251--254",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Improved performance of the greedy algorithm for the minimum set cover and minimum partial cover problems",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Slav\u00edk",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "Elec. Col. on Comp. Complexity",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "NCBI viral genomes resource",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Brister",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Ako-Adjei",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bao",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Blinkova",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Nucleic Acids Res",
            "volume": "43",
            "issn": "",
            "pages": "571--578",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Parameters used by CATCH in default model of hybridization.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Enrichment across segments of influenza A virus (H4N4).Variable enrichment across segments of an influenza A virus sample of subtype H4N4 (IAV-SM5). Segments 4 and 6 contain the most genetic diversity and divergence from probe sequences. No sequences of the N4 subtypes were included in the design of VALL or VWAFR. (a) Depth of coverage across the sample's genome. Each of the eight segments in IAV are labeled. (b, c) Distribution of the enrichment in read depth provided by capture with VALL (b) and VWAFR (c). Each curve represents one of the eight segments. At each position across a genome, the post-capture read depth is divided by the pre-capture depth, and the plotted curve is the empirical cumulative distribution of the log of these fold-change values.Sequencing results of Lassa virus from the 2018 Lassa fever outbreak in Nigeria.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "CATCH reduces much of the design to a problem of determining probe-target hybridization. The function f map , which determines whether a probe hybridizes to a range in a target sequence (and, if it does, precisely the range), can be customized by a user in CATCH's source code or can be provided in a command-line argument to be dynamically loaded. For example, although by default CATCH does not use a thermodynamic model of hybridization, a user could choose to incorporate a calculation of free energy to evaluate the likelihood of hybridization. Here, when computing s(d, \u2713 d ) (defined in Online Methods), CATCH's default f map is based on three parameters in \u2713 d : a number m of mismatches to tolerate, a length lcf of a longest common substring, and a length i of an island of an exact match. f map computes the longest common substring with at most m mismatches between the probe sequence and target subsequence, and returns that the probe covers the target range if and only if the length of this is at least lcf. Optionally (if i > 0), f map additionally requires that the probe and target subsequence share an exact (0-mismatch) match of length at least i to return that the probe covers the range. (SeeSupplementary Fig. 1bfor a visual representation and 'Exploring the parameter space across taxa' in Online Methods for example values.)",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "are colored, and Homo sapiens matches in human plasma samples are shown in black. Asterisks on species indicate ones that are not targeted by VALL. (d) Same as (b) but for VWAFR in the uncharacterized sample pools. Asterisks on species indicate ones that are not targeted by VWAFR. In all panels, abundance was calculated by dividing species counts pre-capture by counts in pooled water controls.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "Depth of coverage observed for viral species detected in uncharacterized samples.Depth of coverage plots for 25 viral genomes detected by metagenomic analysis of uncharacterized samples following capture with VALL (see Fig. 4b ). Read depths are shown on a linear scale.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 219,
                    "end": 226,
                    "text": "Fig. 4b",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Figure 11"
        },
        {
            "text": "CATCH's framework for designing probes o\u21b5ers considerable flexibility. This note describes extensions to probe design and methods behind them.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Note 1"
        }
    ]
}